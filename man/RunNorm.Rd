% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RunNorm.R
\name{RunNorm}
\alias{RunNorm}
\title{RunNorm}
\usage{
RunNorm(
  mat_path,
  design_path,
  fix_reference = NULL,
  row_name_index = 1,
  n_pop = 1,
  n_pop_reference = 1,
  saving_path = NULL,
  sigma_times = 1,
  dist_family = "Skew.normal",
  Norm_plot = TRUE,
  Save_results = TRUE,
  return_full = FALSE,
  BiocParam = NULL,
  cpus = 2
)
}
\arguments{
\item{mat_path}{Input data matrix. Can be:
\itemize{
\item A file path to a .csv, .tsv, or .txt file with rownames in the first column
\item A dense matrix or data.frame
\item A sparse dgCMatrix object (from the Matrix package)
}}

\item{design_path}{Path to the design matrix. Must contain columns: Sample_ID, Sample_Condition, and Sample_Replicate. Layers in conditions are defined by underscores (_).}

\item{fix_reference}{Character vector of Sample_IDs to use as normalization reference. Can also be:
\itemize{
\item "random" to randomly select ~30\% of samples
\item A numeric fraction (e.g. 0.3) to select top-N by intensity
}}

\item{row_name_index}{Integer indicating the column index of rownames in the input file (default = 1). Ignored if input is a matrix or dgCMatrix.}

\item{n_pop}{Number of populations expected in sample-vs-reference fits (default = 1). Set to NULL to auto-detect.}

\item{n_pop_reference}{Number of populations for reference-vs-reference fits (default = 1). NULL for auto.}

\item{saving_path}{Output directory to save results (required if Save_results = TRUE).}

\item{sigma_times}{Multiplier of standard deviation to define invariant interval around the dominant mode (default = 1).}

\item{dist_family}{Distribution family name to use for fitting. Passed to mixsmsn (default = "Skew.normal").}

\item{Norm_plot}{Logical. Whether to generate and save QC plots (default = TRUE). Large datasets may be subsampled for plotting.}

\item{Save_results}{Logical. Whether to save outputs to disk (default = TRUE).}

\item{return_full}{Optional whether to return full models per}

\item{BiocParam}{Optional BiocParallel backend. If NULL, defaults to MulticoreParam(workers = cpus).}

\item{cpus}{Integer. Used if BiocParam is NULL to set number of parallel workers.}
}
\value{
A named list with:
\itemize{
\item scaling_factors: a data.frame of computed scaling coefficients
\item norm_mat: a normalized sparse matrix (dgCMatrix)
\item If return_full = TRUE, also includes model_list: compact model fits
}
}
\description{
Executes the complete normalization pipeline using mixture models fitted to log-ratio distributions between samples.
}
